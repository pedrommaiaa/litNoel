---
import '../styles/global.css';

export interface Props {
    title?: string;
    description?: string;
    ogTitle?: string;
    ogDescription?: string;
    ogImage?: string;
}

const { 
    title = 'Professional Christmas Light Installation | Lit Noel',
    description = 'Professional Christmas light installation across West Georgia & Metro Atlanta. Design, install, maintenance, and takedown. Free quotes. Licensed & insured.',
    ogTitle,
    ogDescription,
    ogImage
} = Astro.props as Props;

let canonicalURL = '';
if (Astro.site) {
	canonicalURL = `${Astro.site.toString().replace(/\/$/, '')}${Astro.url.pathname}`;
} else {
	canonicalURL = Astro.url.pathname;
}

// Resolve OG values with fallbacks
const resolvedOgTitle = ogTitle ?? title;
const resolvedOgDescription = ogDescription ?? description;
const resolvedOgImage = ogImage ?? 'https://litnoel.com/photos/residential-christmas-lights-smyrna-ga-1200.webp';

// Structured data for local business
const structuredData = {
	"@context": "https://schema.org",
	"@type": "LocalBusiness",
	"name": "Lit Noel",
	"description": "Professional Christmas light installation for homes and businesses across West Georgia & Metro Atlanta. Design, install, maintenance, and takedown.",
	"url": "https://litnoel.com",
	"logo": "https://litnoel.com/logo-icon.webp",
	"image": "https://litnoel.com/hero-background.webp",
	"telephone": "+14707806868",
	"email": "litnoelteam@gmail.com",
	"address": {
		"@type": "PostalAddress",
		"addressRegion": "ST",
		"addressCountry": "US"
	},
	"areaServed": [
		{ "@type": "AdministrativeArea", "name": "Cobb County" },
		{ "@type": "AdministrativeArea", "name": "Paulding County" },
		{ "@type": "AdministrativeArea", "name": "Douglas County" },
		{ "@type": "AdministrativeArea", "name": "Carroll County" }
	],
	"contactPoint": {
		"@type": "ContactPoint",
		"telephone": "+14707806868",
		"contactType": "customer service",
		"availableLanguage": "English"
	},
	"openingHours": [
		"Mo-Fr 07:00-19:00",
		"Sa 09:00-17:00",
		"Su 09:00-17:00"
	],
	"priceRange": "$$",
	"hasOfferCatalog": {
		"@type": "OfferCatalog",
		"name": "Holiday Lighting Services",
		"itemListElement": [
			{ "@type": "Offer", "itemOffered": { "@type": "Service", "name": "Christmas Light Installation", "description": "Custom Christmas light installation for homes and businesses" } },
			{ "@type": "Offer", "itemOffered": { "@type": "Service", "name": "In‑Season Maintenance", "description": "Repair or adjust displays during the season" } },
			{ "@type": "Offer", "itemOffered": { "@type": "Service", "name": "Post‑Season Removal", "description": "Careful takedown and cleanup after the holidays" } }
		]
	}
};
---

<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
	<head>
		<meta charset="UTF-8" />
		<meta name="description" content={description} />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="format-detection" content="telephone=no,address=no,email=no" />
		
		<!-- SEO Meta Tags -->
		<title>{title}</title>
		<meta name="keywords" content="Christmas light installation, holiday lighting services, professional Christmas lights, holiday light installation, Christmas light removal, commercial holiday lighting, residential Christmas lights, LED Christmas lights, holiday decorations" />
		<meta name="author" content="Lit Noel" />
		<meta name="creator" content="Lit Noel" />
		<meta name="publisher" content="Lit Noel" />
		
		<!-- Canonical URL -->
		<link rel="canonical" href={canonicalURL} />
		
		<!-- Favicon and Icons -->
		<link rel="icon" type="image/webp" href="/logo-icon.webp" />
		<link rel="apple-touch-icon" href="/logo-icon.webp" />
		<!-- Preload above-the-fold hero image -->
		<link rel="preload" as="image" href="/hero-background.webp" imagesrcset="/hero-background.webp 1920w" imagesizes="100vw" />
		
		<!-- Open Graph Meta Tags -->
        <meta property="og:title" content={resolvedOgTitle} />
        <meta property="og:description" content={resolvedOgDescription} />
        <meta property="og:url" content={canonicalURL} />
		<meta property="og:site_name" content="Lit Noel" />
        <meta property="og:image" content={resolvedOgImage} />
		<meta property="og:image:width" content="1200" />
		<meta property="og:image:height" content="630" />
		<meta property="og:image:alt" content="Lit Noel Logo - Holiday Lighting Services" />
		<meta property="og:locale" content="en_US" />
		<meta property="og:type" content="website" />
		
		<!-- Twitter Card Meta Tags -->
		<meta name="twitter:card" content="summary_large_image" />
        <meta name="twitter:title" content={resolvedOgTitle} />
        <meta name="twitter:description" content={resolvedOgDescription} />
        <meta name="twitter:image" content={resolvedOgImage} />
		<meta name="twitter:creator" content="@LitNoel" />
		
		<!-- Additional SEO Meta Tags -->
		<meta name="theme-color" content="#a73519" />
		<meta name="msapplication-TileColor" content="#a73519" />

		<!-- JSON-LD will be added by each page layout (County/City) -->
		
		<!-- Robots Meta Tags -->
		<meta name="robots" content="index, follow, max-video-preview:-1, max-image-preview:large, max-snippet:-1" />
		<meta name="googlebot" content="index, follow, max-video-preview:-1, max-image-preview:large, max-snippet:-1" />
		
		<!-- Google Fonts -->
		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<!-- Calendly removed: no longer needed -->
		<link rel="preconnect" href="https://unpkg.com" crossorigin />
		<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet" />
		<link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'" />
		<noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" /></noscript>
		
		<!-- Structured Data -->
		<script type="application/ld+json" set:html={JSON.stringify(structuredData)} />
		
		<!-- Google Analytics 4 -->
		<script is:inline>
			// Check if user has opted out before loading analytics
			if (localStorage.getItem('analytics-opted-out') !== 'true') {
				// Google Analytics - Active tracking
				var script = document.createElement('script');
				script.async = true;
				script.src = 'https://www.googletagmanager.com/gtag/js?id=G-7EM3XKTDX2';
				document.head.appendChild(script);
				
				window.dataLayer = window.dataLayer || [];
				function gtag(){dataLayer.push(arguments);}
				gtag('js', new Date());
				gtag('config', 'G-7EM3XKTDX2', {
					page_title: document.title,
					page_location: window.location.href
				});
			}
		</script>
	</head>
	<body class="antialiased">
		<slot />
	</body>
</html>

<style>
	html,
	body {
		margin: 0;
		width: 100%;
		height: 100%;
	}
</style>
